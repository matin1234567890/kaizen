<!DOCTYPE html>
<html  dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kaizen Café</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="./IMG_0184.PNG" type="image/png">
</head>

<body>

<header>
  <img src="./Logo_White.png" alt="Kaizen Cafe Logo" class="logo-img">
  <div class="tagline">Quality • Calm • Coffee</div>
</header>
<div class="layout">
<div id="categories" class="categories"></div>
<div id="products" class="products"></div>
</div>
<div class="footer-box">
  <a class="location-box"
     href="https://maps.app.goo.gl/wm6TXqjfDNRc63sx7"
     target="_blank">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
      <path d="M0 188.6C0 84.4 86 0 192 0S384 84.4 384 188.6c0 119.3-120.2 262.3-170.4 316.8-11.8 12.8-31.5 12.8-43.3 0-50.2-54.5-170.4-197.5-170.4-316.8zM192 256a64 64 0 1 0 0-128 64 64 0 1 0 0 128z"/>
    </svg>
  </a>

  <a class="instagram-box"
     href="https://www.instagram.com/_cafekaizen/"
     target="_blank" rel="noreferrer noopener">
    <img src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png">
  </a>
</div>

<div id="overlay" class="overlay"></div>

<script>
const SHEET_ID = "1uBUhNHeh4zdB7kSj0NfCV1V45JeGMKg6VCSyjP-8hXw";
const URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

let categories = {};

fetch(URL)
  .then(res => res.text())
  .then(text => {
    const json = JSON.parse(text.substr(47).slice(0, -2));
    const rows = json.table.rows.map(r =>
      r.c.map(c => c ? c.v : "")
    );

    const dataRows = rows.slice(1);

    dataRows.forEach(([cat, name, price, desc, image]) => {
      if (!cat) return;
      if (!categories[cat]) categories[cat] = [];
      categories[cat].push({ name, price, desc, image });
    });

    buildCategoryButtons();
  });

function buildCategoryButtons() {
  const container = document.getElementById("categories");
  container.innerHTML = "";

  Object.keys(categories).forEach((cat,index) => {
    const btn = document.createElement("div");
    btn.className = "category-btn";
    btn.textContent = cat;
    btn.onclick = () => selectCategory(cat, btn);
    container.appendChild(btn);

    if(index===0){
      btn.classList.add("active");
      showProducts(cat);
    }
  });
}


function selectCategory(cat, btn) {
  document.querySelectorAll(".category-btn")
    .forEach(b => b.classList.remove("active"));
  btn.classList.add("active");
  showProducts(cat);
}

function showProducts(categoryName) {
  const container = document.getElementById("products");
  const overlay = document.getElementById("overlay");
  container.innerHTML = "";

  categories[categoryName].forEach(item => {
    const card = document.createElement("div");
    card.className = "product-card";

    const imgsrc = item.image ? item.image :"IMG_0184.PNG"
    card.innerHTML = `
      <img class="product-img" src="${imgsrc}">
      <div class="product-info">
        <div class="product-name">${item.name}</div>
        <div class="product-desc">${item.desc}</div>
        <div class="divider"></div>
        <div class="product-price">${item.price} تومان</div>
      </div>
    `;

    card.onclick = () => {
      const opened = document.querySelector(".product-card.expanded");
      if (opened && opened !== card) opened.classList.remove("expanded");
      card.classList.toggle("expanded");
      overlay.classList.toggle("active");
    };

    container.appendChild(card);
  });

  overlay.onclick = () => {
    document.querySelectorAll(".product-card.expanded")
      .forEach(c => c.classList.remove("expanded"));
    overlay.classList.remove("active");
  };
}
</script>


</body>
</html>

